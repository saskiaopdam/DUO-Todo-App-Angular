<header>
  <h2>{{ (todo$ | async)?.length }}</h2>
  <div>
    <ng-container *ngIf="!deleting; else deleteDoneButton">
      <button (click)="startDeleting()">-</button><span> Remove</span>
    </ng-container>

    <ng-template #deleteDoneButton>
      <button (click)="onDeleteDone()">Done</button>
    </ng-template>

    <ng-container *ngIf="!adding; else addingDoneButton">
    </ng-container>

    <ng-template #addingDoneButton>
      <button (click)="onAddingDone()">Done</button>
    </ng-template>
  </div>
</header>

<table>
<!--  <tr *ngFor="let todo of todo$ | async">-->
  <tr *ngFor="let todo of sortedTodos$ | async">
    <!-- conditional render of DELETE button -->
    <ng-container *ngIf="!deleting; else deleteButton"></ng-container>
    <ng-template #deleteButton>
      <td>
      <button (click)="delete(todo.id)">-</button>
      </td>
    </ng-template>
    <td><input type="checkbox" [checked]="todo.checked" (change)="onToggle(todo)"></td>
    <td (click)="startEditing(todo)">
      <!-- conditional render of UPDATE field -->
      <ng-container *ngIf="!editing || editingTodo.id !== todo.id; else editField">
        {{ todo.task }}
      </ng-container>
      <ng-template #editField>
        <input #editInput type="text" [(ngModel)]="editingTodo.task" (keyup.enter)="onEditDone()" (blur)="onEditDone()">
      </ng-template>
    </td>
  </tr>
<!--end of conditional render-->

<!--conditional render of ADDING field-->
<ng-container *ngIf="!adding; else addingField">
</ng-container>
<ng-template #addingField>
  <tr>
    <td><input type="checkbox"></td>
    <td><input #addingInput type="text" [(ngModel)]="addingTodo.task" (keyup.enter)="onAddingDone()" (blur)="onEditDone()"></td>
  </tr>
</ng-template>
<!--end of conditional render-->

</table>

<ng-container *ngIf="!adding; else nothing">
  <button (click)="startAdding()">+</button><span> Add</span>
</ng-container>
<ng-template #nothing></ng-template>






